label: Request examples

cases:
  - label: Sends headers
    request:
      path: /header
      headers:
        header-string: xxx
        Header-String: yyy
        user-agent: custom
    response:
      status_code: 200
      headers:
        - describe: ."content-type"
          should:
            equal: application/json
        - describe:
            jq: ."content-length"
            cast_to: int
          should:
            be_greater_than: 100
      body:
        - describe: ."header-string"
          should:
            equal: yyy
        - describe: ."user-agent"
          should:
            equal: custom

  - label: Sends params as a string
    request:
      path: /params
      params: key=value&spam=ham%26eggs
    response:
      status_code: 200
      body:
        - describe: .key
          should:
            equal: value
        - describe: .spam
          should:
            equal: ham&eggs

  - label: Sends params as a mapping
    request:
      path: /params
      params:
        key: value
        multi-key:
          - value1
          - value2
          - null  # should be ignored.
        boolean-key: false
        integer-key: 1
        float-key: 1.2
        timezone-naive-datetime-key: 2020-01-23T12:34:56
        timezone-aware-datetime-key: 2020-04-01 01:23:45 +09:00
    response:
      status_code: 200
      body:
        - describe: .key
          should:
            equal: value
        - describe: ."multi-key"
          should:
            equal: value2
        - describe: ."boolean-key"
          should:
            equal: "False"
        - describe: ."integer-key"
          should:
            equal: "1"
        - describe: ."float-key"
          should:
            equal: "1.2"
        - describe: ."timezone-naive-datetime-key"
          should:
            - equal: '2020-01-23T12:34:56'
        - describe: ."timezone-aware-datetime-key"
          should:
            - equal: '2020-04-01T01:23:45+09:00'
            - be_before: now
